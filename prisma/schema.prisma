datasource db {
  provider = "sqlite"
}

generator client {
  provider = "prisma-client-js"
}

// --- citas.prisma ---
model Cita {
  id             String    @id @default(cuid())
  fecha          DateTime
  descripcion    String?
  datos          String
  estado         EstadoCita @default(PENDIENTE)

  createdAt      DateTime  @default(now()) @map("creado_en")
  updatedAt      DateTime  @updatedAt @map("actualizado_en")

  @@map("citas")
}

enum EstadoCita {
  PENDIENTE
  CONFIRMADA
  CANCELADA
  COMPLETADA
}
// --- empresa.prisma ---
model Empresa {
  id          String       @id @default(cuid())
  nombre      String
  email       String       @unique
  telefono    String?
  direccion   String?
  sucursales  Sucursal[]
  suscripciones Suscripcion[]
  tratamientos Tratamiento[]
  createdAt   DateTime     @default(now()) @map("creado_en")
  updatedAt   DateTime     @updatedAt @map("actualizado_en")
}

model Sucursal {
  id          String       @id @default(cuid())
  nombre      String
  direccion   String?
  telefono    String?
  empresaId   String
  empresa     Empresa      @relation(fields: [empresaId], references: [id])
  createdAt   DateTime     @default(now()) @map("creado_en")
  updatedAt   DateTime     @updatedAt @map("actualizado_en")
}
// --- suscripciones.prisma ---
model Suscripcion {
  id            String       @id @default(cuid())
  empresaId     String
  empresa       Empresa      @relation(fields: [empresaId], references: [id])
  planId        String
  plan          Plan         @relation(fields: [planId], references: [id])
  cuponId       String?
  cupon         Cupon?       @relation(fields: [cuponId], references: [id])
  fechaInicio   DateTime
  fechaFin      DateTime
  estado        EstadoSuscripcion @default(ACTIVA)
  pagos         Pago[]
  createdAt     DateTime     @default(now()) @map("creado_en")
  updatedAt     DateTime     @updatedAt @map("actualizado_en")
}

model Plan {
  id            String       @id @default(cuid())
  nombre        String
  precioMensual Float
  descripcion   String?
  suscripciones Suscripcion[]
  createdAt     DateTime     @default(now()) @map("creado_en")
  updatedAt     DateTime     @updatedAt @map("actualizado_en")
}

model Cupon {
  id            String       @id @default(cuid())
  codigo        String       @unique
  descuento     Float        // Porcentaje de descuento (0-100)
  fechaExpiracion DateTime
  suscripciones Suscripcion[]
  createdAt     DateTime     @default(now()) @map("creado_en")
  updatedAt     DateTime     @updatedAt @map("actualizado_en")
}

model Pago {
  id            String       @id @default(cuid())
  suscripcionId String
  suscripcion   Suscripcion  @relation(fields: [suscripcionId], references: [id])
  monto         Float
  fecha         DateTime
  metodoPago    MetodoPago
  createdAt     DateTime     @default(now()) @map("creado_en")
  updatedAt     DateTime     @updatedAt @map("actualizado_en")
}

enum EstadoSuscripcion {
  ACTIVA
  CANCELADA
  EXPIRADA
}

enum MetodoPago {
  TARJETA
  TRANSFERENCIA
  PAYPAL
}
// --- tratamientos.prisma ---
model rama {
  id         String       @id @default(cuid())
  descripcion     String
  categorias Categoria[]

  createdAt  DateTime     @default(now()) @map("creado_en")
  updatedAt  DateTime     @updatedAt @map("actualizado_en")

  @@map("rama")
}


model Categoria {
  id            String       @id @default(cuid())
  nombre        String
  tratamientos  Tratamiento[]
  ramaId      String
  rama        rama       @relation(fields: [ramaId], references: [id])
  createdAt     DateTime     @default(now()) @map("creado_en")
  updatedAt     DateTime     @updatedAt @map("actualizado_en")
}


model Tratamiento {
  id            String       @id @default(cuid())
  nombre        String
  descripcion   String?
  precio        Float
  categoriaId   String
  categoria     Categoria    @relation(fields: [categoriaId], references: [id])
  empresaId  String
  empresa      Empresa    @relation( fields: [empresaId], references: [id])
  createdAt     DateTime     @default(now()) @map("creado_en")
  updatedAt     DateTime     @updatedAt @map("actualizado_en")
}

